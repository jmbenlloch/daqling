# Enrico.Gamberini@cern.ch

- name: Download and unpack boost_1_70_0
  unarchive:
    src: https://dl.bintray.com/boostorg/release/1.70.0/source/boost_1_70_0.tar.gz
    dest: /opt/
    remote_src: yes

- name: Bootstrap
  shell: ./bootstrap.sh --prefix=/opt/boost >> bootstrap.txt
  args:
    chdir: /opt/boost_1_70_0/
  environment:
    LD_LIBRARY_PATH: "/opt/ohpc/pub/compiler/gcc/8.3.0/lib64/:{{ ansible_env.LD_LIBRARY_PATH }}"
    PATH: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin:{{ ansible_env.PATH }}"
    CC: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin/gcc"
    CXX: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin/g++"

- name: Install Boost in /opt/boost_1_70_0/
  shell: ./b2 install >> b2install.txt
  args:
    chdir: /opt/boost_1_70_0/
  environment:
    LD_LIBRARY_PATH: "/opt/ohpc/pub/compiler/gcc/8.3.0/lib64/:{{ ansible_env.LD_LIBRARY_PATH }}"
    PATH: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin:{{ ansible_env.PATH }}"
    CC: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin/gcc"
    CXX: "/opt/ohpc/pub/compiler/gcc/8.3.0/bin/g++"

- name: Remove Boost source folder
  file:
    path: /opt/boost_1_70_0
    state: absent
