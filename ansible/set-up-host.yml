---
- hosts: localhost
  remote_user: "{{ lookup('env','LOGNAME') }}"
  become: yes
  become_method: sudo
  roles:
    - { role: lib-centos, when: ansible_distribution == 'CentOS' or ansible_distribution == 'Red Hat Enterprise Linux', tags: minimal }
    - { role: devel, tags: minimal }
    - firewall
    - twiddler
    - { role: openhpc, tags: minimal }
    # - cvmfs
    - control-deps
    - { role: externals, tags: minimal }
  environment:
    LD_LIBRARY_PATH: "{{ lookup('env','LD_LIBRARY_PATH') }}" 
    PATH: "{{ lookup('env','PATH') }}"
    CC: "{{ lookup('env','CC') or '/opt/ohpc/pub/compiler/gcc/8.3.0/bin/gcc' }}"
    CXX: "{{ lookup('env','CXX') or '/opt/ohpc/pub/compiler/gcc/8.3.0/bin/g++' }}"
    http_proxy: "{{ lookup('env','http_proxy') }}" 
    https_proxy: "{{ lookup('env','https_proxy') }}" 
